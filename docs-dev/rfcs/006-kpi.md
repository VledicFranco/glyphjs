# RFC-006: KPI

- **Status:** Implemented
- **Parent:** [RFC-002: Component Roadmap](./002-component-roadmap.md)
- **Priority:** P4
- **Complexity:** S
- **Block type:** `ui:kpi`

---

## 1. Summary

A KPI (Key Performance Indicator) card component for displaying metrics, statistics, and key figures with labels, values, optional trend indicators, and deltas.

## 2. Motivation

LLMs frequently summarize data into key takeaways: "Revenue grew 15% to $2.3M." Today this is rendered as plain text, which buries the numbers in prose. A KPI component makes figures visually prominent and scanable, especially when presenting multiple metrics together.

## 3. Schema

````yaml
```ui:kpi
metrics:
  - label: Revenue
    value: "$2.3M"
    delta: "+15%"
    trend: up
  - label: Users
    value: "48,200"
    delta: "+3,100"
    trend: up
  - label: Churn
    value: "2.1%"
    delta: "-0.3%"
    trend: down
    sentiment: positive
  - label: NPS
    value: "72"
````

````

### Zod schema

```typescript
const kpiSchema = z.object({
  title: z.string().optional(),
  metrics: z.array(z.object({
    label: z.string(),
    value: z.string(),
    delta: z.string().optional(),
    trend: z.enum(['up', 'down', 'flat']).optional(),
    sentiment: z.enum(['positive', 'negative', 'neutral']).optional(),
    unit: z.string().optional(),
  })).min(1).max(8),
  columns: z.number().min(1).max(4).optional(),
});
````

## 4. Visual design

- Renders as a horizontal grid of cards (1–4 columns, auto-calculated from metric count or explicit).
- Each card shows:
  - **Label** — small, muted text at top (`--glyph-text-muted`).
  - **Value** — large, prominent text (`--glyph-heading`, 1.5–2rem).
  - **Delta + trend** — below the value, with arrow direction from `trend` (▲/▼/—) and color from `sentiment`: green for `positive`, red for `negative`, gray for `neutral`. Default sentiment: `positive` when trend is `up`, `negative` when `down`, `neutral` when `flat`.
- Trend indicator: small arrow icon (▲/▼/—) next to the delta.
- Cards have subtle border and surface-raised background.
- Responsive: wraps to fewer columns on narrow viewports.

## 5. Accessibility

- Each card is a `<div>` with `role="group"` and `aria-label` combining label and value (e.g., "Revenue: $2.3M, up 15%").
- Trend direction is conveyed through text ("up", "down", "flat"), not just color/icon.
- The overall component has `role="region"` with `aria-label` from the optional title.

## 6. Implementation notes

- This is the simplest component in the roadmap — pure layout with no interactivity or graph computation.
- The `value` field is a string (not number) to allow formatted values like "$2.3M" or "48,200" — the LLM handles formatting.
- `trend` semantics: `trend` reflects the **actual direction** of change (`up` = value increased, `down` = value decreased, `flat` = no change). It controls the arrow direction. Color is controlled by `sentiment`: `positive` (green), `negative` (red), `neutral` (gray). Default sentiment follows the trend direction (`up` → positive, `down` → negative), but can be overridden — e.g., churn going down is `trend: down, sentiment: positive` (down arrow, green color).
- Custom CSS variables for sentiment colors: `--glyph-kpi-positive` (green), `--glyph-kpi-negative` (red), `--glyph-kpi-neutral` (gray).
